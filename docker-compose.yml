services:
  rag-api:
    build: ./rag-api
    expose:
      - "8000"
    environment:
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - QDRANT_HOST=qdrant
      - QDRANT_PORT=6333
      - MATTERMOST_API_URL=${MATTERMOST_API_URL}
      - MATTERMOST_BOT_TOKEN=${MATTERMOST_BOT_TOKEN}
      - MATTERMOST_INCOMING_WEBHOOK_URL=${MATTERMOST_INCOMING_WEBHOOK_URL}
      - MATTERMOST_OUTGOING_WEBHOOK_TOKEN=${MATTERMOST_OUTGOING_WEBHOOK_TOKEN}
    depends_on:
      - qdrant
    networks:
      - localproxy
    restart: unless-stopped

  qdrant:
    image: qdrant/qdrant:latest
    expose:
      - "6333"
    networks:
      - localproxy
    volumes:
      - qdrant_data:/qdrant/storage
    restart: unless-stopped

networks:
  localproxy:
    external: true

volumes:
  qdrant_data:
